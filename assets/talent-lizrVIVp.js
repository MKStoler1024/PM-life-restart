class o extends ui.view.DefaultTheme.TalentUI{constructor(){super(),this.btnDrawCard.on(Laya.Event.CLICK,this,this.onClickDrawCard),this.btnNext.on(Laya.Event.CLICK,this,this.onClickNext),this.listTalents.renderHandler=Laya.Handler.create(this,this.renderTalent,null,!1),this.listTalents.scrollBar.elasticDistance=150}#e=new Set;init(){this.pageDrawCard.visible=!0,this.pageResult.visible=!1,this.btnNext.label="UI_Talent_Select_Uncomplete",this.#e.clear()}close(){}onClickDrawCard(){this.pageDrawCard.visible=!1,this.pageResult.visible=!0,this.listTalents.array=core.talentRandom()}onClickNext(){if(this.#e.size<core.talentSelectLimit)return $$event("message",["F_TalentSelectNotComplect",core.talentSelectLimit]);const e=[...this.#e].map(t=>this.listTalents.array[t]);$ui.switchView(UI.pages.PROPERTY,{talents:e,enableExtend:!0})}renderTalent(e,t){const s=e.dataSource,r=e.getChildByName("blank");e.label=$_.format($lang.F_TalentSelection,s);const i=$ui.common.card[s.grade],n=()=>{const a=this.#e.has(t);r.pause=!a,$_.deepMapSet(e,a?i.selected:i.normal)};n(),e.offAll(Laya.Event.CLICK),e.on(Laya.Event.CLICK,this,()=>{if(this.#e.has(t))this.#e.delete(t);else{if(this.#e.size>=core.talentSelectLimit)return $$event("message",["F_TalentSelectLimit",core.talentSelectLimit]);const a=core.exclude([...this.#e].map(l=>this.listTalents.array[l].id),this.listTalents.array[t].id);if(a!=null){for(const{name:l,id:c}of this.listTalents.array)if(a==c)return $$event("message",["F_TalentConflict",l]);return}this.#e.add(t)}this.btnNext.label=this.#e.size===core.talentSelectLimit?"UI_Next":"UI_Talent_Select_Uncomplete",n()})}}export{o as default};
