class c extends ui.view.CyberTheme.CyberPropertyUI{constructor(){super();const t=this.#e=core.PropertyTypes;this.btnCharmIncrease.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.CHR,1]),this.btnCharmReduce.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.CHR,-1]),this.btnIntelligenceIncrease.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.INT,1]),this.btnIntelligenceReduce.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.INT,-1]),this.btnStrengthIncrease.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.STR,1]),this.btnStrengthReduce.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.STR,-1]),this.btnMoneyIncrease.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.MNY,1]),this.btnMoneyReduce.on(Laya.Event.CLICK,this,this.onPropertyAllocate,[t.MNY,-1]),this.inputCharm.on(Laya.Event.INPUT,this,this.onPropertyAllocateInput,[t.CHR]),this.inputIntelligence.on(Laya.Event.INPUT,this,this.onPropertyAllocateInput,[t.INT]),this.inputStrength.on(Laya.Event.INPUT,this,this.onPropertyAllocateInput,[t.STR]),this.inputMoney.on(Laya.Event.INPUT,this,this.onPropertyAllocateInput,[t.MNY]);const e=({currentTarget:s})=>{s.text=""};this.inputCharm.on(Laya.Event.MOUSE_DOWN,this,e),this.inputIntelligence.on(Laya.Event.MOUSE_DOWN,this,e),this.inputStrength.on(Laya.Event.MOUSE_DOWN,this,e),this.inputMoney.on(Laya.Event.MOUSE_DOWN,this,e),this.btnRandomAllocate.on(Laya.Event.CLICK,this,this.random),this.btnNext.on(Laya.Event.CLICK,this,this.next),this.listSelectedTalents.renderHandler=Laya.Handler.create(this,this.renderTalent,null,!1)}#e;#i;#s;#t;init({talents:t}){this.listSelectedTalents.array=t;const e=core.remake(t.map(s=>s.id));e.length>0&&$$event("message",[e.map(s=>["F_TalentReplace",s])]),this.#i=core.getPropertyPoints(),this.#t=core.propertyAllocateLimit,this.labLeftPropertyPoint.text=this.#i,this.#s={[this.#e.CHR]:0,[this.#e.INT]:0,[this.#e.STR]:0,[this.#e.MNY]:0},this.updateAllocate()}next(){const t=this.#i-this.total;if(t>0)return $$event("message",["F_PropertyPointLeft",t]);$ui.switchView(UI.pages.TRAJECTORY,{propertyAllocate:this.#s,talents:this.listSelectedTalents.array,enableExtend:!0})}get total(){return this.#s[this.#e.CHR]+this.#s[this.#e.INT]+this.#s[this.#e.STR]+this.#s[this.#e.MNY]}updateAllocate(){const t=this.#s[this.#e.CHR],e=this.#s[this.#e.INT],s=this.#s[this.#e.STR],i=this.#s[this.#e.MNY];this.inputCharm.text=""+t,this.inputIntelligence.text=""+e,this.inputStrength.text=""+s,this.inputMoney.text=""+i,this.labLeftPropertyPoint.text=this.#i-this.total,this.btnCharmIncrease.disabled=this.btnCharmIncrease.gray=!1,this.btnCharmReduce.disabled=this.btnCharmReduce.gray=!1,this.btnIntelligenceIncrease.disabled=this.btnIntelligenceIncrease.gray=!1,this.btnIntelligenceReduce.disabled=this.btnIntelligenceReduce.gray=!1,this.btnStrengthIncrease.disabled=this.btnStrengthIncrease.gray=!1,this.btnStrengthReduce.disabled=this.btnStrengthReduce.gray=!1,this.btnMoneyIncrease.disabled=this.btnMoneyIncrease.gray=!1,this.btnMoneyReduce.disabled=this.btnMoneyReduce.gray=!1,this.total>=this.#i?(this.btnCharmIncrease.disabled=this.btnCharmIncrease.gray=!0,this.btnIntelligenceIncrease.disabled=this.btnIntelligenceIncrease.gray=!0,this.btnStrengthIncrease.disabled=this.btnStrengthIncrease.gray=!0,this.btnMoneyIncrease.disabled=this.btnMoneyIncrease.gray=!0):this.total<=0&&(this.btnCharmReduce.disabled=this.btnCharmReduce.gray=!0,this.btnIntelligenceReduce.disabled=this.btnIntelligenceReduce.gray=!0,this.btnStrengthReduce.disabled=this.btnStrengthReduce.gray=!0,this.btnMoneyReduce.disabled=this.btnMoneyReduce.gray=!0),t<=this.#t[0]?this.btnCharmReduce.disabled=this.btnCharmReduce.gray=!0:t>=this.#t[1]&&(this.btnCharmIncrease.disabled=this.btnCharmIncrease.gray=!0),e<=this.#t[0]?this.btnIntelligenceReduce.disabled=this.btnIntelligenceReduce.gray=!0:e>=this.#t[1]&&(this.btnIntelligenceIncrease.disabled=this.btnIntelligenceIncrease.gray=!0),s<=this.#t[0]?this.btnStrengthReduce.disabled=this.btnStrengthReduce.gray=!0:s>=this.#t[1]&&(this.btnStrengthIncrease.disabled=this.btnStrengthIncrease.gray=!0),i<=this.#t[0]?this.btnMoneyReduce.disabled=this.btnMoneyReduce.gray=!0:i>=this.#t[1]&&(this.btnMoneyIncrease.disabled=this.btnMoneyIncrease.gray=!0)}check(t,e,s){return!(s<t||s>e)}random(){let t=this.#i;const e=new Array(4).fill(this.#t[1]);for(;t>0;){const s=Math.round(Math.random()*(Math.min(t,this.#t[1])-1))+1;for(;;){const i=Math.floor(Math.random()*4)%4;if(!(e[i]-s<0)){e[i]-=s,t-=s;break}}}this.#s[this.#e.CHR]=this.#t[1]-e[0],this.#s[this.#e.INT]=this.#t[1]-e[1],this.#s[this.#e.STR]=this.#t[1]-e[2],this.#s[this.#e.MNY]=this.#t[1]-e[3],this.updateAllocate()}onPropertyAllocate(t,e){this.check(this.#t[0],this.#t[1],this.#s[t]+e)&&this.check(0,this.#i,this.total+e)&&(this.#s[t]+=e,this.updateAllocate())}onPropertyAllocateInput(t,e){let s=parseInt(e.text)||0;const i=this.total;i+s<0?s=this.#t[0]*4-i:i+s>this.#i&&(s=this.#i-i),s<this.#t[0]?s=this.#t[0]:s>this.#t[1]&&(s=this.#t[1]);const n=s-this.#s[t];n?this.onPropertyAllocate(t,n):this.updateAllocate()}renderTalent(t){const e=t.dataSource,s=t.getChildByName("labTitle"),i=t.getChildByName("grade1"),n=t.getChildByName("grade2"),a=t.getChildByName("grade3"),h=t.getChildByName("grade4"),r=t.getChildByName("labDescription");switch(s.text=e.name,r.text=e.description,e.grade){case 1:i.visible=!0,n.visible=!1,a.visible=!1,h.visible=!1;break;case 2:i.visible=!1,n.visible=!0,a.visible=!1,h.visible=!1;break;case 3:i.visible=!1,n.visible=!1,a.visible=!0,h.visible=!1;break;case 4:i.visible=!1,n.visible=!1,a.visible=!1,h.visible=!0;break;default:i.visible=!1,n.visible=!1,a.visible=!1,h.visible=!1;break}}}export{c as default};
