class m extends ui.view.CyberTheme.CyberTalentUI{constructor(){super(),this.btnDrawCard.on(Laya.Event.CLICK,this,this.onClickDrawCard),this.btnNext.on(Laya.Event.CLICK,this,this.onClickNext),this.listTalents.renderHandler=Laya.Handler.create(this,this.renderTalent,null,!1),this.listTalents.scrollBar.elasticDistance=150,this.on(Laya.Event.RESIZE,this,()=>{const e=this.listTalents?._itemRender?.props?.width;if(e){const t=Math.max(Math.floor((this.width-40)/e),1);this.listTalents.width=t*e+(t-1)*(this.listTalents.spaceY||0)}})}#e=new Set;static load(){return["images/background/background_2@3x.png"]}init(){this.pageDrawCard.visible=!0,this.pageResult.visible=!1,this.btnNext.label="UI_Talent_Select_Uncomplete",this.#e.clear()}close(){}onClickDrawCard(){this.pageDrawCard.visible=!1,this.pageResult.visible=!0,this.listTalents.array=core.talentRandom()}onClickNext(){if(this.#e.size<core.talentSelectLimit)return $$event("message",["F_TalentSelectNotComplect",core.talentSelectLimit]);const e=[...this.#e].map(t=>this.listTalents.array[t]);$ui.switchView(UI.pages.PROPERTY,{talents:e,enableExtend:!0})}renderTalent(e,t){const c=e.dataSource,d=e.getChildByName("hboxTitle"),i=d.getChildByName("labTitle"),s=d.getChildByName("grades"),a=s.getChildByName("grade1"),l=s.getChildByName("grade2"),n=s.getChildByName("grade3"),r=s.getChildByName("grade4"),f=e.getChildByName("labDescription"),o=e.getChildByName("unselected"),b=e.getChildByName("selected");switch(c.grade){case 1:s.x=0,i.x=1,a.visible=!0,l.visible=!1,n.visible=!1,r.visible=!1;break;case 2:s.x=0,i.x=1,a.visible=!1,l.visible=!0,n.visible=!1,r.visible=!1;break;case 3:s.x=0,i.x=1,a.visible=!1,l.visible=!1,n.visible=!0,r.visible=!1;break;case 4:s.x=0,i.x=1,a.visible=!1,l.visible=!1,n.visible=!1,r.visible=!0;break;default:s.x=1,i.x=0,a.visible=!1,l.visible=!1,n.visible=!1,r.visible=!1;break}i.text=c.name,i.event(Laya.Event.RESIZE),f.text=c.description,o.visible=!(b.visible=this.#e.has(t)),e.offAll(Laya.Event.CLICK),e.on(Laya.Event.CLICK,this,()=>{if(this.#e.has(t))this.#e.delete(t);else{if(this.#e.size>=core.talentSelectLimit)return $$event("message",["F_TalentSelectLimit",core.talentSelectLimit]);const v=core.exclude([...this.#e].map(h=>this.listTalents.array[h].id),this.listTalents.array[t].id);if(v!=null){for(const{name:h,id:g}of this.listTalents.array)if(v==g)return $$event("message",["F_TalentConflict",h]);return}this.#e.add(t)}this.btnNext.label=this.#e.size===core.talentSelectLimit?"UI_Next":"UI_Talent_Select_Uncomplete",o.visible=!(b.visible=this.#e.has(t))})}}export{m as default};
